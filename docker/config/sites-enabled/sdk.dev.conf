<VirtualHost *:80>

    DocumentRoot /var/www/html/public
    ServerName spp.dev

    <Directory />
        Options FollowSymLinks
        AllowOverride None
    </Directory>

    # Protect files and directories from prying eyes.
    <Files ~ "(\.(inc|module|pl|sh|sql|theme|engine|xtmpl)|Entries|Repositories|Root|scripts|updates|svn|git)$">
        Require all denied
    </Files>

    # Set some options.
    Options -Indexes
    Options +FollowSymLinks

    # Customized error messages.
    ErrorDocument 404 /index.php

    # Set the default handler.
    DirectoryIndex index.php

    # Making some headers for P3P
    Header append P3P 'CP="CAO DSP COR CUR ADMi DEV TAI HISi PSAi CONi OUR DELi OTRi IND PHY ONL PUR UNI COM NAV INT DEM STA"'

    # Add X-Frame-Options to block iframing
    Header always append X-Frame-Options DENY

    # Override PHP settings. More exist in sites/default/settings.php, but
    # the following cannot be changed at runtime. The first IfModule is
    # for Apache 1.3, the second for Apache 2.
    <IfModule mod_php5.c>
        php_value magic_quotes_gpc                0
        php_value register_globals                0
        php_value session.auto_start              0
    </IfModule>

    <IfModule sapi_apache2.c>
        php_value magic_quotes_gpc                0
        php_value register_globals                0
        php_value session.auto_start              0
    </IfModule>

    <Directory /var/www/html/public/>
        # Various rewrite rules.
        <IfModule mod_rewrite.c>
            RewriteEngine on

            # Rewrite old api/endpoint URLs to api/2/endpoint
            RewriteRule    api/([^0-9\.]/*.+)$    /api/2/$1       [L]

            # Rewrite current-style URLs of the form 'index.php?q=x'.
            RewriteCond %{REQUEST_FILENAME} !-f
            RewriteCond %{REQUEST_FILENAME} !-d

            RewriteRule ^(.*)$ index.php?c=$1 [L,QSA]
        </IfModule>
    </Directory>

    <Directory /var/www/html/>
        Options FollowSymLinks
        AllowOverride None
        Require all granted
    </Directory>

    # Possible values include: debug, info, notice, warn, error, crit, alert, emerg.
    LogLevel info
    ErrorLog ${APACHE_LOG_DIR}/spp.dev-error.log
    CustomLog ${APACHE_LOG_DIR}/spp.dev-access.log combined

</VirtualHost>

